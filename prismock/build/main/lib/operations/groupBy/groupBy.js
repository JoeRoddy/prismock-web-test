"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.groupBy = groupBy;
const helpers_1 = require("../../helpers");
const aggregate_1 = require("../aggregate");
const find_1 = require("../find");
const match_1 = require("../find/match");
function groupBy(args, current, delegates) {
    const by = Array.isArray(args.by) ? args.by : [args.by];
    const items = (0, find_1.findMany)({ where: args.where }, current, delegates);
    const grouped = divideIntoGroups(args, by, items);
    const filtered = having(grouped, args.having, current, delegates);
    const ordered = orderWithAggregates(filtered, args, current, delegates);
    return ordered.map((group) => extractDesiredFields(args, group));
}
function having(items, arg, current, delegates) {
    if (arg === undefined) {
        return items;
    }
    const flattenedArg = flattenHaving(arg);
    return items.filter(({ havingValue }) => {
        const result = (0, match_1.matchMultiple)(havingValue, flattenedArg, current, delegates);
        return result;
    });
}
function flattenHaving(having) {
    return Object.fromEntries(Object.entries(having).flatMap(([key, value]) => {
        if (['AND', 'OR', 'NOT'].includes(key)) {
            return [[key, (0, helpers_1.ensureArray)(value).map((v) => flattenHaving(v))]];
        }
        if (typeof value === 'object') {
            const hasAgg = Object.keys(value).some((k) => k.startsWith('_'));
            if (!hasAgg) {
                return [[key, value]];
            }
            return Object.entries(value).map(([nestedKey, nestedValue]) => {
                return [key + nestedKey, nestedValue];
            });
        }
        return [[key, value]];
    }));
}
function orderWithAggregates(groups, args, delegate, delegates) {
    if (!args.orderBy)
        return groups;
    const propertiesToOrderBy = Array.isArray(args.orderBy) ? args.orderBy : [args.orderBy];
    const o = propertiesToOrderBy.reduceRight((accumulator, currentValue) => {
        const acc = accumulator.sort((a, b) => (0, find_1.calculateOrder)(a.orderByValue, b.orderByValue, currentValue, delegate, delegates));
        return acc;
    }, groups);
    return o;
}
function extractDesiredFields(args, { groupKey, items }) {
    return Object.assign(Object.assign({}, groupKey), (0, aggregate_1.aggregate)(Object.assign(Object.assign({}, args), { cursor: undefined }), items));
}
function divideIntoGroups(args, by, items) {
    return items
        .reduce((groups, item) => {
        const itemKey = (0, helpers_1.pick)(item, by);
        let group = groups.find(([groupKey]) => (0, helpers_1.shallowCompare)(groupKey, itemKey));
        if (!group) {
            group = [itemKey, [item]];
            groups.push(group);
        }
        else {
            group[1].push(item);
        }
        return groups;
    }, [])
        .map(([groupKey, items]) => {
        return {
            groupKey,
            items,
            orderByValue: buildOrderByValue(args, groupKey, items),
            havingValue: buildHavingValue(args, groupKey, items),
        };
    });
}
function buildOrderByValue(args, groupKey, items) {
    if (args.orderBy === undefined) {
        return {};
    }
    const aggregateArgs = (0, helpers_1.ensureArray)(args.orderBy).reduce((agg, each) => Object.entries(each).filter(([key]) => key.startsWith('_')).reduce((agg, [aggregation, fields]) => {
        return Object.assign(agg, mergeAggregateArg(aggregation, agg[aggregation], fields));
    }, agg), {});
    return Object.assign(Object.assign({}, groupKey), (0, aggregate_1.aggregate)(aggregateArgs, items));
}
function extractDesiredHavingAggregates(having, result = {}) {
    return Object.entries(having).reduce((agg, [field, value]) => {
        if (['AND', 'OR', 'NOT'].includes(field)) {
            return (0, helpers_1.ensureArray)(value).reduce((a, each) => extractDesiredHavingAggregates(each, a), agg);
        }
        else {
            Object.keys(value)
                .filter((k) => k.startsWith('_'))
                .forEach((aggregation) => {
                var _a;
                const aggKey = aggregation;
                agg[aggKey] = ((_a = agg[aggKey]) !== null && _a !== void 0 ? _a : []).concat([field]);
            });
            return agg;
        }
    }, result);
}
function buildHavingValue(args, groupKey, items) {
    if (args.having === undefined) {
        return {};
    }
    const desiredAggregates = extractDesiredHavingAggregates(args.having);
    const aggregateArgs = Object.fromEntries(Object.entries(desiredAggregates).map(([field, aggregates]) => [
        field,
        Object.fromEntries((0, helpers_1.unique)(aggregates).map((agg) => [agg, true])),
    ]));
    return Object.assign(Object.assign({}, groupKey), flattenAggregate((0, aggregate_1.aggregate)(aggregateArgs, items)));
}
function flattenAggregate(aggregate) {
    const result = {};
    Object.entries(aggregate).forEach(([aggregate, fields]) => {
        Object.entries(fields).forEach(([field, value]) => {
            result[field + aggregate] = value;
        });
    });
    return result;
}
function mergeAggregateArg(aggregation, aggregate, value) {
    const valueToProcess = aggregate
        ? Object.keys(value).reduce((agg, key) => Object.assign(agg, { [key]: true }), aggregate)
        : value;
    return {
        [aggregation]: Object.fromEntries(Object.keys(valueToProcess).map((k) => [k, true])),
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ3JvdXBCeS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvb3BlcmF0aW9ucy9ncm91cEJ5L2dyb3VwQnkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFRQSwwQkFTQztBQWhCRCwyQ0FBMEU7QUFHMUUsNENBQXlDO0FBQ3pDLGtDQUFtRDtBQUNuRCx5Q0FBOEM7QUFFOUMsU0FBZ0IsT0FBTyxDQUFDLElBQWlCLEVBQUUsT0FBaUIsRUFBRSxTQUFvQjtJQUNoRixNQUFNLEVBQUUsR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDeEQsTUFBTSxLQUFLLEdBQUcsSUFBQSxlQUFRLEVBQUMsRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLEtBQUssRUFBRSxFQUFFLE9BQU8sRUFBRSxTQUFTLENBQUMsQ0FBQztJQUNsRSxNQUFNLE9BQU8sR0FBRyxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsRUFBRSxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQ2xELE1BQU0sUUFBUSxHQUFHLE1BQU0sQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLE1BQU0sRUFBRSxPQUFPLEVBQUUsU0FBUyxDQUFDLENBQUM7SUFFbEUsTUFBTSxPQUFPLEdBQUcsbUJBQW1CLENBQUMsUUFBUSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsU0FBUyxDQUFDLENBQUM7SUFFeEUsT0FBTyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxvQkFBb0IsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQztBQUNuRSxDQUFDO0FBRUQsU0FBUyxNQUFNLENBQUMsS0FBa0IsRUFBRSxHQUEwQixFQUFFLE9BQWlCLEVBQUUsU0FBb0I7SUFDckcsSUFB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